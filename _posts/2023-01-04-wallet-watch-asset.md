---
title: "[Blockchain/Ethereum] EIP-747: wallet_watchAsset"
date: 2023-01-04 17:20:00 +09:00
tags: study blockchain metamask
comments: true
---

<a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://infiduk.github.io/2023/01/04/wallet-watch-asset.html&count_bg=%23EDD513&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=%E2%9C%A8+page+view+%E2%9C%A8&edge_flat=false" /></a>

EIP-747: wallet_watchAsset

## TL;DR

`wallet_watchAsset` μ€

μ‚¬μ©μμ μ›Ή μ›”λ ›(μ§€κ°‘)μ— ν† ν°(μμ‚°)μ„ μ¶”κ°€ν•  μ μλ„λ΅ μ μ•ν•λ” RPC λ©”μ†λ“λ΅,

μ•„λμ λ°©λ²•μ²λΌ μ‚¬μ©ν•λ©΄ λλ‹¤.

```jsx
...
ethereum.request({
  method: 'wallet_watchAsset',
  params: {
    type: 'ERC20',
    options: {
      address: '0xb60e8dd61c5d32be8058bb8eb970870f07233155',
      symbol: 'FOO',
      decimals: 18,
      image: 'https://foo.io/token-image.svg',
    },
  },
});
  .then((success) => {
    if (success) {
      console.log('FOO successfully added to wallet!')
    } else {
      throw new Error('Something went wrong.')
    }
  })
  .catch(console.error)
...
```

ν•΄λ‹Ή μ½”λ“λ¥Ό μ μ©ν•΄ λ³΄λ©΄,

λ©”νƒ€λ§μ¤ν¬ μµμ¤ν…μ…μ—λ” μ•„λμ μΊ΅μ³ ν™”λ©΄κ³Ό κ°™μ΄ λ‚νƒ€λ‚λ‹¤.

ν† ν° μ¶”κ°€ λ²„νΌμ„ λ„λ¥΄λ©΄ μµμ¤ν…μ…μ— ν•΄λ‹Ή ν† ν°μ΄ μ¶”κ°€λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

![1.png](https://user-images.githubusercontent.com/48206157/210513798-cdedba55-c502-49a4-a183-886dbced92a1.png)

## μ£Όμ €λ¦¬

μ¤λλ„ ν‰ν™”λ΅μ΄ μΈν”Όλ•μ νμ‚¬ μƒν™

μ‚¬λ‚΄μ—μ„ κ°λ° μ¤‘μΈ μ„λΉ„μ¤λ” ν•„μ—°μ μΌλ΅ μ—¬λ¬ μΆ…λ¥μ ν† ν°(μ½”μΈ)μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” μ„λΉ„μ¤λ΅,

μ‚¬μ©μκ°€ λ³ΈμΈμ ν† ν°(μμ‚°)μ„ ν™•μΈν•λ ¤λ©΄

ν•λ‚ν•λ‚ λ©”νƒ€λ§μ¤ν¬ μµμ¤ν…μ…μ— μ¶”κ°€ν•΄μ•Όν•λ” λ²κ±°λ΅μ›€μ΄ μμ—λ‹¤ γ…

μ‚¬μ‹¤ μ΄ λ‚΄μ©μ„ μΈμ§€ν•μ§€ μ•κ³  μλ‹¤κ°€, μ–Όλ§ μ „μ— μ΄λ° κΈ°λ¥μ΄ μμ—μΌλ©΄ μΆ‹κ² λ‹¤λ” μκ²¬μ„ λ“¤μ—λ μΈν”Όλ•

ν€μ¥λ‹κ³Ό λλΉ› κµν™ ν›„ RPC μ½ λ•λ¦΄ λ§ν• μΉκµ¬λ¥Ό μ°Ύμ•„λ³΄κ² λλ”λ°..

## wallet_watchAsset

### μ΄κ² λ¨Έμ„

μ‚¬μ©μ μ›Ή μ›”λ ›(μ§€κ°‘)μ— ν† ν°(μμ‚°)μ„ μ¶”κ°€ν•  μ μλ„λ΅ μ μ•ν•λ” RPC λ©”μ†λ“

### μ–΄λ””λ‹¤ μ”€

μ›Ή μ›”λ ›μ΄λ‚ λΈ”λ΅μ²΄μΈ λ‘ μ„λΉ„μ¤, ν† ν°μ„ μ‚¬μ©ν•λ” λ¨λ“  κ³³μ— κ°€λ¥ν• κ²ƒμΌλ΅ λ³΄μΈλ‹¤.

### μ™ μ”€

~μμ‹λ΅ μ„¤λ…~

μ›λ‚  μ›μ μ—.. νΈλ‘μ΄ λ‹΄λ°°ν”Όλ μ‹μ β€¦

μ›Ή μ›”λ ›μ„ μ‚¬μ©ν•κ³  μλ” μΈν”Όλ•μ€ `INFIDUK` μ΄λΌλ” ν† ν°λ§ κ°€μ§€κ³  μμ—λ‹¤.

(μ›Ή μ›”λ ›μ΄λΌλ” λ‹¨μ–΄κ°€ μ–΄λ µλ‹¤λ©΄ λ©”νƒ€λ§μ¤ν¬λΌκ³  μƒκ°ν•΄λ„ μΆ‹λ‹¤.)

μΈν”Όλ•μ΄ `MAPLE` μ΄λΌλ” ν† ν°μ„ 100κ° μ •λ„ μ—μ–΄λ“λ λ°›μ•λ‹¤κ³  μƒκ°ν•΄ λ³΄μ.

ν•μ§€λ§ μΈν”Όλ•μ€ `INFIDUK` ν† ν°λ§ κ°€μ§€κ³  μμ—κΈ° λ•λ¬Έμ— μ§€κ°‘ μƒμΌλ΅λ” `MAPLE` ν† ν°μ„ ν™•μΈν•  μ μ—†μ—λ‹¤. (ν† ν°μ„ μ¶”κ°€ν•΄μ•Ό μ›”λ ›μ— λ³΄μ„)

λ‹Ήν™©ν• μΈν”Όλ•μ€ μ§€κ°‘μ— `MAPLE` ν† ν°μ„ μ¶”κ°€ν•κΈ° μ„ν•΄ κµ¬κΈ€λ§ν•λ©° λ™λ™ μ•“μ•κ³ ,

λ§μΉ¨λ‚΄ `MAPLE` ν† ν°μ μ£Όμ†μ™€ μ‹¬λ³Ό, μ†μμ  λ“±μ„ μ•μ•„λ‚΄μ–΄

μ§€κ°‘ λ‚΄μ μμ‚° μ¶”κ°€ κΈ°λ¥μ„ μ°Ύμ•„ ν•΄λ‹Ή λ‚΄μ©μΌλ΅ λ³ΈμΈμ΄ μ‚¬μ©ν•λ” μ§€κ°‘μ— `MAPLE` ν† ν°μ„ μ¶”κ°€ν–λ‹¤.

β€¦

μ΄μ™€ κ°™μ€ μ‚¬μ©μμ λ¶€μ •μ μΈ κ²½ν—μ„ λ°©μ§€ν•κΈ° μ„ν•΄

κ°λ°μ μΈ΅λ©΄μ—μ„ `wallet_watchAsset` λ©”μ†λ“λ¥Ό μ‚¬μ©ν• κΈ°λ¥μ„ μ„λΉ„μ¤μ— λ„£μ–΄λ‘λ©΄

(λ²„νΌμ„ λ„λ¥΄λ©΄ `wallet_watchAsset` λ©”μ†λ“λ¥Ό νΈμ¶ν•λ” μ½”λ“)

μ‚¬μ©μλ” λ²„νΌ ν•λ²μ— μ‰½κ³  κ°„λ‹¨ν•κ² ν† ν°μ„ μ¶”κ°€ν•  μ μκ² λλ‹¤.

**μ΄λ΄ λ• μ‚¬μ©ν•λ©΄ μΆ‹μ€ RPC λ©”μ†λ“**

### μ–΄μΌ€ μ”€ (νλμ¤)

λ¬Έμ„μ—λ” μ•„λμ™€ κ°™μ΄ μ •λ¦¬λμ–΄ μλ‹¤.

```jsx
interface WatchAssetParameters {
  type: string; // μ¶”κ°€ν•λ ¤λ” μμ‚°μ νƒ€μ… (μ•„λ§λ„ λ€λ¶€λ¶„μ΄ 'ERC20' μΌ κ²ƒ)
  options: {
    address: string, // ν† ν° μ»¨νΈλ™νΈ μ£Όμ†
    symbol?: string, // μ‹¬λ³Ό μ΄λ¦„
    decimals?: number, // μ†μμ  (μ•„λ§λ„ λ€λ¶€λ¶„ 18μΌν…λ°, μ™λƒλ©΄ μ΄λ”λ¦¬μ›€μ΄ 18 μ„)
    image?: string, // ν† ν° μ΄λ―Έμ§€ (png, jpg, svg λ“±μ μ΄λ―Έμ§€ λ§ν¬ νΉμ€ base64 ν•νƒ)
  };
}
```

### γ„Ήγ…‡λ΅ μ–΄μΌ€ μ”€

λ‹¤λ¥Έ EIP λ©”μ†λ“λ“¤κ³Ό λ™μΌν•κ² `ethereum.request` λ¥Ό μ‚¬μ©ν•λ©°,

νλμ¤λ΅λ” μ„μ—μ„ μ•μ•„λ³Έ μΉκµ¬λ“¤μ„ λ„£μΌλ©΄ λλ‹¤.

μ•„λμ μ½”λ“λ” μ¶”κ°€ν•  ν† ν°μ νƒ€μ…μ΄ **ERC20**μΌ κ²½μ°μ— μ •μƒμ μΌλ΅ λ™μ‘ν•λ” μ½”λ“μ΄κ³ ,

μ½”λ“λ” μ•„λμ™€ κ°™μ΄

```jsx
...
ethereum.request({
  method: 'wallet_watchAsset',
  params: {
    type: 'ERC20',
    options: {
      address: '0xb60e8dd61c5d32be8058bb8eb970870f07233155',
      symbol: 'FOO',
      decimals: 18,
      image: 'https://foo.io/token-image.svg',
    },
  },
});
  .then((success) => {
    if (success) {
      console.log('FOO successfully added to wallet!')
    } else {
      throw new Error('Something went wrong.')
    }
  })
  .catch(console.error)
...
```

μ΄λ° μ‹μΌλ΅ μ‘μ„±ν•λ©΄ λλ‹¤.

νλμ¤μ— λ“¤μ–΄κ°€λ” κ°’λ“¤μ€ λ¬Έμ„μ— μ •λ¦¬λ κ·Έλ€λ΅ μ‚¬μ©ν–λ‹¤.

λ¦¬ν„΄λλ” κ°’μ€ `boolean` νƒ€μ…μΌλ΅ λ‚΄λ ¤μ¤λ”λ°, μμ‚°μ΄ μ •μƒμ μΌλ΅ μ¶”κ°€λ κ²½μ° `true` κ°€,

κ·Έ μ΄μ™Έμ κ²½μ°λ” λ¨λ‘ μ—λ¬λ΅ μ²λ¦¬ν•λ©΄ λλ‹¤.

ν•΄λ‹Ή μ½”λ“λ¥Ό μ μ©ν•΄ λ³΄λ©΄,

λ©”νƒ€λ§μ¤ν¬ μµμ¤ν…μ…μ—λ” μ•„λμ μΊ΅μ³ ν™”λ©΄κ³Ό κ°™μ΄ λ‚νƒ€λ‚λ‹¤.

ν† ν° μ¶”κ°€ λ²„νΌμ„ λ„λ¥΄λ©΄ μµμ¤ν…μ…μ— ν•΄λ‹Ή ν† ν°μ΄ μ¶”κ°€λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

![2.png](https://user-images.githubusercontent.com/48206157/210513798-cdedba55-c502-49a4-a183-886dbced92a1.png)

μ™„λ£~

## μ£Όμ €λ¦¬2

μ•„μ§ ν•κµ­μ—μ„λ” μ΄ λ©”μ†λ“λ¥Ό μ‚¬μ©ν•λ” κ³³μ΄ λ§μ΄ μ—†λ‚λ³΄λ‹¤.

κµ¬κΈ€λ§ν•΄λ„ ν•κΈ€λ΅ μ“°μΈ λ¬Έμ„κ°€ μ—†λ” κ±Έ λ³΄λ©΄..

κ·Έλ ‡λ‹¤λ©΄β€¦β€¦.λ‚΄κ°€β€¦β€¦β€¦β€¦β€¦β€¦β€¦. λ§¨ μ²μβ€¦..?! π¥΄

## μ°Έκ³ 

- [EIP-747: Add wallet_watchAsset to Provider](https://eips.ethereum.org/EIPS/eip-747)
